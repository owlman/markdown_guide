# 第四章 谈谈数学问题

## 本章提要

在之前的两章中，我们以笔者大学毕业时的论文撰写过程为导引，逐一为大家介绍了`Markdown`的基本语法，以及这种轻量型标记语言在写作阶段的大部分应用。到目前为止，关于写作阶段的内容，我们就只剩下“如何用`Markdown`来描述数学问题”这一议题没有讨论了。之所以一直避而不谈这个议题，一方面是因为笔者的这篇论文主要论证的是一个网上书籍销售系统的构建过程，本身并没有涉及到数学问题。另一方面，更重要的是因为在`Markdown`文档中描述数学问题要涉及到$\LaTeX$标记的运用，相对比较复杂，所以我们打算单独用一章的篇幅来讨论这个议题。

在这一章中，我们首先会介绍如何在`Markdown`文档中插入$\LaTeX$标记，以呈现数学公式。然后，我们会具体介绍如何用$\LaTeX$标记来描述基本四则运算、二项式方程、矩阵运算以及集合运算等数学问题。相信在学习完本章的内容之后，大家应该都能随心所欲地在`Markdown`文档中讨论数学问题了。

## 4.1 使用$\LaTeX$标记

在`Markdown`中，数学问题的描述是通过引入$\LaTeX$标记来完成的。由于$\LaTeX$本身就是一门独立的标记语言，所以在介绍如何引入其相关标记之前，我们最好先对这门语言做一个简单的介绍。

### 4.1.1 $\LaTeX$是什么？

事情得从$\TeX$说起，众所周知，$\TeX$是美国著名的计算机教授高德纳（Donald Ervin Knuth）[^1]为撰写其伟大著作《计算机程序设计艺术》专门开发的一套排版系统。由于《计算机程序设计艺术》是一部讨论计算机算法的鸿篇巨作，其中涉及了大量的数学问题，所以为其开发的排版系统自然就在编辑复杂的数学公式方面具备了与生俱来的优势，这种先天优势使得它在数学、物理学和计算机科学等与数学表述密切相关的学术领域中非常流行，甚至很多人学习$\TeX$就是为了使用它在数学领域中的强大表述能力。

但$\TeX$的功能过于强大，它会要求我们在排版过程中精确描述到每一个细节，有时甚至是一个字母或标点也要照顾到。这对于大多数人来说，可能就学习成本太高，并且用起来太过繁琐和费时了。于是在上个世纪80年代，美国计算机科学家莱斯利·兰伯特（Leslie Lamport）[^2]在$\TeX$的基础上开发出了$\LaTeX$这个新的排版系统（目前的版本为$\LaTeX2e$）。从本质上来说，该排版系统其实就是一组封装了$\TeX$处理细节的宏，它可以让那些不了解排版和程序设计相关知识的人们也能使用$\TeX$所提供的强大功能，并在几天甚至几个小时之内就能排版出具有专业质感的印刷品，而不必深陷于琐碎的排版细节中。

在中文支持方面，$\LaTeX$目前主要使用的`XeTeX`排版引擎，该引擎支持UTF-8编码和现代字体，可以直接使用本地计算机中安装的字体，这大大降低了$\LaTeX$的使用难度。

### 4.1.2 插入$\LaTeX$标记

正如上面所说的，$\LaTeX$本质上是一组封装了$\TeX$处理细节的宏。所以我们接下来所使用的每一个标记实际上都是一个宏。$\LaTeX$的这些标记主要有两种形式，第一种形式是数学公式，而数学公式的编辑原本就是本章的主要议题，我们会在下一节中做详细介绍。在这里，我们要先来简单了解一下$\LaTeX$标记的命令形式，因为这种形式也会出现在复杂的公式中。这种形态的$\LaTeX$标记通常会以一个反斜杠开头，后面紧接着该命令的名称，这个名称既可能是个单一符号，也可能是一个字符串。命令名称之后还可以有一些指定参数，我们通常会用花括号将它们括起来（如果该参数只有一个字符，花括号可以省略）。除此之外，如果有可选参数，则用方括号括起来，具体如下：

- 无参数形式：`\command`。
- 有参数形式：`\command{参数1}{参数2}……{参数N}`。
- 带可选参数形式：`\command[可选参数]{参数1}{参数2}……{参数N}`。
  

例如，我们现在在这里所显示的“$\LaTeX$”字样，使用的就是一个无参数形式的$\LaTeX$标记命令`\LaTeX`。再例如，我们后面会需要对数学公式进行自动编号，这时候就需要用到带参数的$\LaTeX$标记命令`\begin{equation}`与`\end{equation}`。

在`Markdown`中，引入$\LaTeX$标记的工作是靠`Mathjax`库[^3]来完成的。和我们之前使用`Mermaid`库一样，`MathJax`也是一个跨浏览器的`JavaScript`程序库，它使用`MathML`、`LaTeX`和`ASCIIMathML`标记在Web浏览器中显示数学符号。当然，在使用这个库之前，必须要先确认我们所使用的`Markdown`编辑器是支持`Mathjax`的，譬如在VSCode编辑器中，我们需要安装Markdown+Math插件。

在设置好编辑环境之后，我们就可以在`Markdown`文档中插入$\LaTeX$标记了。具体来说，$\LaTeX$标记的引用方式主要有以下两种：

- **行内引用**：采用行内引用方式的$\LaTeX$标记通常与正常文本处于同一逻辑行中（软件界面导致的自动换行不算），具体语法就是*在待引用标记的前后各加一个美元符号*。例如，如果我们想显示“我正在使用$\LaTeX$来排版论文。”这句话，只需进行如下编码即可：
  
  ```Markdown
  我正在使用$\LaTeX$来排版论文。
  ```

- **单独引用**：采用单独引用方式的$\LaTeX$标记通常会独立于正常文本，自成一行，具体语法就是*在待引用标记的前后各加两个美元符号*。例如，如果我们想讨论勾股定理，就可以使用如下编码来描述该定理：

  ```Markdown
  在平面上的一个直角三角形中，如果设直角三角形的两条直角边长度分别是a和b，斜边长度是c，那么按照勾股定理，这三边的关系如下：
  
  $$ a^{2} + b^{2} = c^{2} $$
  
  这也就意味着：
  
  $$ a = \sqrt{c^{2} - b^{2}} $$
  $$ b = \sqrt{c^{2} - a^{2}} $$
  $$ c = \sqrt{a^{2} + b^{2}} $$
  ```

  其渲染效果如下

  > 在平面上的一个直角三角形中，如果设直角三角形的两条直角边长度分别是a和b，斜边长度是c，那么按照勾股定理，这三边的关系如下：
  >
  > $$ a^{2} + b^{2} = c^{2} $$
  >
  > 这也就意味着：
  >
  > $$ a = \sqrt{c^{2} - b^{2}} $$  
  > $$ b = \sqrt{c^{2} - a^{2}} $$  
  > $$ c = \sqrt{a^{2} + b^{2}} $$

请暂时不用担心看不懂上面所使用的$\LaTeX$标记，因为我们会在下一节中详细介绍这些标记及其使用方法。在这里，大家只需要对$\LaTeX$标记的引用方式有清楚的认知就可以了。

## 4.2 编辑数学公式

数学公式的编辑一直以来都是我们在撰写科学类文章过程中所面临的最大麻烦之一，相信各位之前应该都尝试过各种在电子文档中输入数学公式的方法，但这些方法多数都不尽如人意，这恐怕也是驱使很多人最终下定决心来学习$\LaTeX$的主要原因。毕竟，对数学公式进行编辑和排版本身就是$\TeX$最重要的设计初衷之一，目前似乎也找不到比它更强大的数学公式编辑方法了。所以在接下来的内容中，我们就来详细、深入地介绍一下如何用$\LaTeX$编辑数学公式。

### 4.2.1 初识公式

众所周知，数学公式与普通文本最大的不同就在于，数学公式中的每一个字符都有特定的含义，这些字符并不像普通文本那样只是单纯地横向或纵向排列，它们有一套属于自己的特殊结构和规则。例如，在上面勾股定理的推导公式中：

$$ c = \sqrt{a^{2} + b^{2}} $$

我们可以看到，$a$和$b$都由各自的平方号，外面还套着一个开根号，这些数学符号的排列既复杂又井然有序，在电子文档中实现这样的排列结构就是我们使用$\LaTeX$编辑数学公式要完成的主要工作。

在$\LaTeX$中，数学公式按照$\LaTeX$表示引用方式的不同，也可以分为采用行内引用的**行内公式**和采用单独引用的**行间公式**两大类。譬如$f(x,y)= x^2 + y^2$，这就是一个行内公式，它们通常与普通文本同处于一个逻辑行内。而行间公式则就是我们在上面关于描述沟勾股定理的示例所看到的那种形式，它们通常独立于普通文本，自成一行。

在了解了数学公式的独特性和它们在文档中的引用形式之后，接下来就可以正式开始学习数学公式的编辑了。下面，让我们先从最基本的四则运算开始。在`Markdown`中编写四则运算的公式很简单，就是在相应的数学表达式加上$\LaTeX$标记，譬如，如果我们想编写$x=a+b-c*d$这样的公式，就只需要输入`$x=a+b-c*d$`即可（当然也可以使用行间公式的形式）。在这里，大家心里可能会有一个疑问：加减乘除这些运算中使用的符号都是可以直接从键盘输入的，描述这类运算时似乎没有必要使用$\LaTeX$标记吧？要想回答这个疑问，我们不妨先来看看使用$\LaTeX$标记前后的区别：

![使用LaTeX标记前后的区别](img/4-1.png)

如你所见，相同的表达式在使用了$\LaTeX$标记之后，表达式中的每个字符都被设置了特定的字体。譬如，字母采用了倾斜的意大利字体，而数字和加号则采用的是直立的等宽字体，并且每个字符之间也都设置了相应的间距。正是这些排版样式将一个干巴巴的表达式变成了具有学术质感的数学公式。所以，即使没有用到任何特殊符号，我们也会建议读者尽量使用$\LaTeX$标记来描述数学问题。

### 4.2.2 公式结构

正如我们之前所说，编辑数学公式并不是在简单地堆砌一堆数学符号，它们都是一些特定结构的组合。我们可以仔细回想一下自己迄今为止所见过的各种公式，看看是不是能从中提炼出几种特定的公式结构？这些结构中有哪些规则？下面我们就来回答一下这两个问题，用$\LaTeX$标记来描述一下这些公式结构。

#### 4.2.3.1 上标与下标

在众多数学公式中，上标和下标无疑是两种最常见的公式结构了。其中，上标通常位于其目标符号的右上方，而下标则通常位于其目标符号的右下方，但在某些情况下，它们也会出现在目标符号的正上方和正下方，例如$10^2$、$a_i$、$a^2_i$、$\sum\limits_{i=0}^n$等。

在$\LaTeX$中，上标用特殊字符“^”表示，下标用特殊字符“`_`”表示，上标和下标可以同时作用于同一个目标符号，并且它们的顺序是可以互换的，我们可以先写上标再写下标，也可以反过来写，两者互不影响。另外，如果上标或下标的内容的多于一个字符，就用括号将其括起来。下面来具体演示一下：

| 公式编码             | 渲染效果            |
|---------------------|-------------------|
| `$10^2$`            | $10^2$            |
| `$2^{1024}$`        | $2^{1024}$        |
| `$a_i$`             | $a_i$             |
| `$a_{i+1}$`         | $a_{i+1}$         |
| `$a_i^2$`           | $a_i^2$           |
| `$a^2_i$`           | $a^2_i$           |
| `$A_{i,j}=2^{i+j}$` | $A_{i,j}=2^{i+j}$ |

除此之外，上标与下标之间还是可以相互嵌套的，譬如：

| 公式编码             | 渲染效果            |
|---------------------|-------------------|
| `$2^{n_i}$`         | $2^{n_i}$         |
| `$2_{n^i}$`         | $2_{n^i}$         |
| `$2^{n^i}$`         | $2^{n^i}$         |
| `$2_{n_i}$`         | $2_{n_i}$         |
| `$2^{2^{2^{2}}}$`   | $2^{2^{2^{2}}}$   |

在求和、积分等这类算子符号上，$\LaTeX$基于排版因素的考虑，为避免文字过于拥挤或难看的行间距，对于行内公式和行间公式的上下标位置有不同的处理，譬如以求和式为例，其行内公式的上下标位于求和符号的右上角和右下角，而行间公式则位于求和符号的正上方和正下方。当然，我们也可以使用特定的$\LaTeX$标记来指定上下标的位置。例如，如果想让求和式的行内公式采用与行间公式相同的上下标位置，可以对它使用`\limits`标记。下面，我们来具体演示一下求和式的上下标：

![求和式的上下标](img/4-2.png)

不止如此，我们还可以引用`amsmath`宏组中的$\LaTeX​$标记，对上下标的位置进行更精确的指定。例如使用`\sideset`标记，可以在一个符号的四个角上各指定一个上下标。除此之外，我们还可以通过`\overset`或`\underset`标记来指定一般符号的上下标位于其正上方或正下方。下面，我们就来演示一下这些标记的使用：

| 公式编码                              | 渲染效果                           |
|-------------------------------------|-----------------------------------|
| `$\sideset{^a_b}{} A$`              | $\sideset{^a_b}{} A$              |
| `$\sideset{}{^c_d} A$`              | $\sideset{}{^c_d} A$              |
| `$\sideset{^a_b}{^c_d} A$`          | $\sideset{^a_b}{^c_d} A$          |
| `$\overset{*}{A}$`                  | $\overset{*}{A}$                  |
| `$\underset{*}{A}$`                 | $\underset{*}{A}$                 |
| `$\overset{*}{\underset{*}{A}}$`    | $\overset{*}{\underset{*}{A}}$    |

对于`amsmath`宏组中其他与上下标相关的$\LaTeX$标记，读者 可以自行参考相关的$\LaTeX$文档，这里就不再一一累述了。

#### 4.2.3.2 线条与括号

#### 4.2.3.3 分式结构

#### 4.2.3.4 根式结构

#### 4.2.3.5 向量与矩阵

### 4.2.3 各类符号

## 本章小结

<!-- 以下是注释区 -->

[^1]:注释：高德纳教授是现代计算机科学的先驱人物，他创立了算法分析理论，并在数个计算机理论分支上都做出了犹如基石一般的贡献，于1974年荣获图灵奖。
[^2]:注释：莱斯利·兰伯特是来自纽约的一位计算机科学家，$\LaTeX$排版系统的开发者，2013年荣获图灵奖。
[^3]:注释：官方网站：https://www.mathjax.org

